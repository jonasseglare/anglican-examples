;; gorilla-repl.fileformat = 1

;; **
;;; # Gaussian with Unknown Mean (AISTATS)
;;; 
;;; This is the Gaussian with unknown mean  benchmark from the 2014 AISTATS paper, with analytical posterior.
;; **

;; @@
(ns gaussian-aistats
  (:require [gorilla-plot.core :as plot]
            [clojure.core.matrix :as m]
            [anglican.stat :as s])
  (:use clojure.repl
        [anglican 
          core runtime emit]))

(defn- square [x] (m/mul x x))

(defn kl-normal 
  "calculates the kl divergence beween two 
  normal distributions from parameters"
  [p-mean p-sigma q-mean q-sigma]
  (+ (- (log q-sigma)
     	(log p-sigma))
     (/ (+ (square p-sigma)
           (square (- p-mean
                      q-mean)))
        (* 2 (square q-sigma)))
     (/ -1 2)))           
;; @@
;; =>
;;; {"type":"list-like","open":"","close":"","separator":"</pre><pre>","items":[{"type":"list-like","open":"","close":"","separator":"</pre><pre>","items":[{"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"},{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/square</span>","value":"#'gaussian-aistats/square"}],"value":"[nil,#'gaussian-aistats/square]"},{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/kl-normal</span>","value":"#'gaussian-aistats/kl-normal"}],"value":"[[nil,#'gaussian-aistats/square],#'gaussian-aistats/kl-normal]"}
;; <=

;; **
;;; ## Define model
;; **

;; @@
(defquery gaussian
  "Returns the posterior distribution on the mean 
  of a Gaussian, conditioned on a list of observations"
  [observations sigma mu0 sigma0]
  (let [mu (sample (normal mu0 sigma0))
        likelihood (normal mu sigma)]
    
    (loop [i 0]
      (if (< i (count observations))
        
        (let [x (nth observations i)]
          (observe likelihood x)
          (recur (+ i 1)))
        
        mu))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/gaussian</span>","value":"#'gaussian-aistats/gaussian"}
;; <=

;; **
;;; ## True Posterior
;; **

;; @@
(def posterior (normal 7.25 (sqrt (/ 1.0 1.2))))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/posterior</span>","value":"#'gaussian-aistats/posterior"}
;; <=

;; **
;;; ## Run inference
;; **

;; @@
(def number-of-samples 100000)

(def samples
  (->> (doquery :rmh
                gaussian 
                [[9.0 8.0] (sqrt 2.0) 1.0 (sqrt 5.0)])
       (take number-of-samples)
       doall
       time))
;; @@
;; ->
;;; &quot;Elapsed time: 4434.252973 msecs&quot;
;;; 
;; <-
;; =>
;;; {"type":"list-like","open":"","close":"","separator":"</pre><pre>","items":[{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/number-of-samples</span>","value":"#'gaussian-aistats/number-of-samples"},{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/samples</span>","value":"#'gaussian-aistats/samples"}],"value":"[#'gaussian-aistats/number-of-samples,#'gaussian-aistats/samples]"}
;; <=

;; **
;;; ## Plot Empirical Distribution vs True Posterior
;; **

;; @@
(def mu-values 
  (map :result samples))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/mu-values</span>","value":"#'gaussian-aistats/mu-values"}
;; <=

;; @@
(plot/histogram mu-values)
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91","values":[{"x":1.5919747955689942,"y":0},{"x":2.0962654492562307,"y":8.0},{"x":2.600556102943467,"y":0.0},{"x":3.1048467566307036,"y":0.0},{"x":3.60913741031794,"y":3.0},{"x":4.113428064005176,"y":17.0},{"x":4.617718717692412,"y":68.0},{"x":5.122009371379648,"y":695.0},{"x":5.626300025066884,"y":2714.0},{"x":6.13059067875412,"y":7218.0},{"x":6.634881332441356,"y":13778.0},{"x":7.139171986128592,"y":20371.0},{"x":7.643462639815828,"y":22093.0},{"x":8.147753293503065,"y":17117.0},{"x":8.652043947190302,"y":9993.0},{"x":9.156334600877539,"y":4096.0},{"x":9.660625254564776,"y":1388.0},{"x":10.164915908252013,"y":354.0},{"x":10.66920656193925,"y":87.0},{"x":11.173497215626487,"y":0}]}],"marks":[{"type":"line","from":{"data":"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"interpolate":{"value":"step-before"},"fill":{"value":"steelblue"},"fillOpacity":{"value":0.4},"stroke":{"value":"steelblue"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91\", :values ({:x 1.5919747955689942, :y 0} {:x 2.0962654492562307, :y 8.0} {:x 2.600556102943467, :y 0.0} {:x 3.1048467566307036, :y 0.0} {:x 3.60913741031794, :y 3.0} {:x 4.113428064005176, :y 17.0} {:x 4.617718717692412, :y 68.0} {:x 5.122009371379648, :y 695.0} {:x 5.626300025066884, :y 2714.0} {:x 6.13059067875412, :y 7218.0} {:x 6.634881332441356, :y 13778.0} {:x 7.139171986128592, :y 20371.0} {:x 7.643462639815828, :y 22093.0} {:x 8.147753293503065, :y 17117.0} {:x 8.652043947190302, :y 9993.0} {:x 9.156334600877539, :y 4096.0} {:x 9.660625254564776, :y 1388.0} {:x 10.164915908252013, :y 354.0} {:x 10.66920656193925, :y 87.0} {:x 11.173497215626487, :y 0})}], :marks [{:type \"line\", :from {:data \"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :interpolate {:value \"step-before\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 0.4}, :stroke {:value \"steelblue\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"4fa43f76-7840-4c80-a0e0-a7ce35ff9e91\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}]}}"}
;; <=

;; @@
(let [mu-min (reduce min mu-values)
      mu-max (reduce max mu-values)]
  (plot/plot #(exp (observe* posterior %)) [mu-min mu-max]))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"295c140e-875c-4721-84fd-0f51601e5df4","values":[{"x":1.5919747955689942,"y":1.9888141443531237E-9},{"x":1.6827471114287889,"y":3.6652818919180403E-9},{"x":1.7735194272885835,"y":6.688465022004647E-9},{"x":1.864291743148378,"y":1.2085133071464517E-8},{"x":1.9550640590081727,"y":2.1621325312101995E-8},{"x":2.0458363748679673,"y":3.830179109019804E-8},{"x":2.136608690727762,"y":6.718336505725297E-8},{"x":2.2273810065875566,"y":1.1668373444361847E-7},{"x":2.318153322447351,"y":2.0066183767456448E-7},{"x":2.408925638307146,"y":3.4168439756660966E-7},{"x":2.4996979541669404,"y":5.760914215966581E-7},{"x":2.590470270026735,"y":9.617530370222887E-7},{"x":2.6812425858865296,"y":1.5897968133915748E-6},{"x":2.7720149017463243,"y":2.6021095437921385E-6},{"x":2.862787217606119,"y":4.217114828752827E-6},{"x":2.9535595334659135,"y":6.767233712013634E-6},{"x":3.044331849325708,"y":1.0752583453951099E-5},{"x":3.1351041651855027,"y":1.6916883794805984E-5},{"x":3.2258764810452973,"y":2.635322730021223E-5},{"x":3.316648796905092,"y":4.0649307127868944E-5},{"x":3.4074211127648866,"y":6.208381335048456E-5},{"x":3.498193428624681,"y":9.388787712200531E-5},{"x":3.588965744484476,"y":1.4058744944355983E-4},{"x":3.6797380603442704,"y":2.0844404011973952E-4},{"x":3.770510376204065,"y":3.060118962695062E-4},{"x":3.8612826920638597,"y":4.4482894156735065E-4},{"x":3.9520550079236543,"y":6.402560027688938E-4},{"x":4.042827323783449,"y":9.124733304400866E-4},{"x":4.1335996396432435,"y":0.0012876344825350813},{"x":4.224371955503038,"y":0.0017991646718378078},{"x":4.315144271362833,"y":0.002489173270399211},{"x":4.405916587222627,"y":0.0034099282460951833},{"x":4.496688903082422,"y":0.004625314304239406},{"x":4.587461218942217,"y":0.006212167493345287},{"x":4.678233534802011,"y":0.008261348850262201},{"x":4.769005850661806,"y":0.010878390981311622},{"x":4.8597781665216,"y":0.014183527786479376},{"x":4.950550482381395,"y":0.01831090298068706},{"x":5.04132279824119,"y":0.023406752175139694},{"x":5.132095114100984,"y":0.029626370522422805},{"x":5.222867429960779,"y":0.03712971714760241},{"x":5.3136397458205735,"y":0.04607557134455738},{"x":5.404412061680368,"y":0.0566142443966754},{"x":5.495184377540163,"y":0.06887896286494499},{"x":5.585956693399957,"y":0.08297616919437226},{"x":5.676729009259752,"y":0.09897512520339148},{"x":5.767501325119547,"y":0.11689734208462375},{"x":5.858273640979341,"y":0.13670648320711587},{"x":5.949045956839136,"y":0.15829947821833862},{"x":6.0398182726989305,"y":0.1814996338447189},{"x":6.130590588558725,"y":0.20605251550170225},{"x":6.22136290441852,"y":0.2316252953047228},{"x":6.312135220278314,"y":0.2578101128271451},{"x":6.402907536138109,"y":0.2841317783381155},{"x":6.4936798519979035,"y":0.3100598751301435},{"x":6.584452167857698,"y":0.335025006079551},{"x":6.675224483717493,"y":0.3584386041254276},{"x":6.765996799577287,"y":0.3797154154209896},{"x":6.856769115437082,"y":0.3982974974261749},{"x":6.947541431296877,"y":0.41367838028765985},{"x":7.038313747156671,"y":0.425425941522396},{"x":7.129086063016466,"y":0.4332025563005947},{"x":7.2198583788762605,"y":0.436781213351819},{"x":7.310630694736055,"y":0.4360565232760984},{"x":7.40140301059585,"y":0.4310498743696404},{"x":7.492175326455644,"y":0.42190838399479824},{"x":7.582947642315439,"y":0.4088977172361709},{"x":7.673719958175234,"y":0.39238926200697993},{"x":7.764492274035028,"y":0.3728425244919474},{"x":7.855264589894823,"y":0.3507839089654116},{"x":7.946036905754617,"y":0.3267832475780921},{"x":8.036809221614412,"y":0.30142953480461376},{"x":8.127581537474207,"y":0.27530729529242604},{"x":8.218353853334001,"y":0.24897488128791506},{"x":8.309126169193796,"y":0.22294577463329002},{"x":8.39989848505359,"y":0.19767368361941293},{"x":8.490670800913385,"y":0.17354190583813994},{"x":8.58144311677318,"y":0.15085710439490338},{"x":8.672215432632974,"y":0.12984734381219737},{"x":8.762987748492769,"y":0.11066397613513354},{"x":8.853760064352564,"y":0.09338677293120279},{"x":8.944532380212358,"y":0.0780315733732114},{"x":9.035304696072153,"y":0.06455966335420255},{"x":9.126077011931947,"y":0.05288811007714981},{"x":9.216849327791742,"y":0.04290034025410107},{"x":9.307621643651537,"y":0.0344563541877477},{"x":9.398393959511331,"y":0.027402097485108246},{"x":9.489166275371126,"y":0.02157765220406008},{"x":9.57993859123092,"y":0.01682404681166352},{"x":9.670710907090715,"y":0.012988609054187732},{"x":9.76148322295051,"y":0.009928890470090272},{"x":9.852255538810304,"y":0.007515271802987489},{"x":9.943027854670099,"y":0.005632413909206447},{"x":10.033800170529894,"y":0.004179750227267497},{"x":10.124572486389688,"y":0.0030712275542077623},{"x":10.215344802249483,"y":0.0022344958819236578},{"x":10.306117118109277,"y":0.0016097299313363592},{"x":10.396889433969072,"y":0.0011482392227769786},{"x":10.487661749828867,"y":8.109939866667059E-4},{"x":10.578434065688661,"y":5.671641711964913E-4},{"x":10.669206381548456,"y":3.9274063626346226E-4}]}],"marks":[{"type":"line","from":{"data":"295c140e-875c-4721-84fd-0f51601e5df4"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#FF29D2"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"295c140e-875c-4721-84fd-0f51601e5df4","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"295c140e-875c-4721-84fd-0f51601e5df4","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"295c140e-875c-4721-84fd-0f51601e5df4\", :values ({:x 1.5919747955689942, :y 1.9888141443531237E-9} {:x 1.6827471114287889, :y 3.6652818919180403E-9} {:x 1.7735194272885835, :y 6.688465022004647E-9} {:x 1.864291743148378, :y 1.2085133071464517E-8} {:x 1.9550640590081727, :y 2.1621325312101995E-8} {:x 2.0458363748679673, :y 3.830179109019804E-8} {:x 2.136608690727762, :y 6.718336505725297E-8} {:x 2.2273810065875566, :y 1.1668373444361847E-7} {:x 2.318153322447351, :y 2.0066183767456448E-7} {:x 2.408925638307146, :y 3.4168439756660966E-7} {:x 2.4996979541669404, :y 5.760914215966581E-7} {:x 2.590470270026735, :y 9.617530370222887E-7} {:x 2.6812425858865296, :y 1.5897968133915748E-6} {:x 2.7720149017463243, :y 2.6021095437921385E-6} {:x 2.862787217606119, :y 4.217114828752827E-6} {:x 2.9535595334659135, :y 6.767233712013634E-6} {:x 3.044331849325708, :y 1.0752583453951099E-5} {:x 3.1351041651855027, :y 1.6916883794805984E-5} {:x 3.2258764810452973, :y 2.635322730021223E-5} {:x 3.316648796905092, :y 4.0649307127868944E-5} {:x 3.4074211127648866, :y 6.208381335048456E-5} {:x 3.498193428624681, :y 9.388787712200531E-5} {:x 3.588965744484476, :y 1.4058744944355983E-4} {:x 3.6797380603442704, :y 2.0844404011973952E-4} {:x 3.770510376204065, :y 3.060118962695062E-4} {:x 3.8612826920638597, :y 4.4482894156735065E-4} {:x 3.9520550079236543, :y 6.402560027688938E-4} {:x 4.042827323783449, :y 9.124733304400866E-4} {:x 4.1335996396432435, :y 0.0012876344825350813} {:x 4.224371955503038, :y 0.0017991646718378078} {:x 4.315144271362833, :y 0.002489173270399211} {:x 4.405916587222627, :y 0.0034099282460951833} {:x 4.496688903082422, :y 0.004625314304239406} {:x 4.587461218942217, :y 0.006212167493345287} {:x 4.678233534802011, :y 0.008261348850262201} {:x 4.769005850661806, :y 0.010878390981311622} {:x 4.8597781665216, :y 0.014183527786479376} {:x 4.950550482381395, :y 0.01831090298068706} {:x 5.04132279824119, :y 0.023406752175139694} {:x 5.132095114100984, :y 0.029626370522422805} {:x 5.222867429960779, :y 0.03712971714760241} {:x 5.3136397458205735, :y 0.04607557134455738} {:x 5.404412061680368, :y 0.0566142443966754} {:x 5.495184377540163, :y 0.06887896286494499} {:x 5.585956693399957, :y 0.08297616919437226} {:x 5.676729009259752, :y 0.09897512520339148} {:x 5.767501325119547, :y 0.11689734208462375} {:x 5.858273640979341, :y 0.13670648320711587} {:x 5.949045956839136, :y 0.15829947821833862} {:x 6.0398182726989305, :y 0.1814996338447189} {:x 6.130590588558725, :y 0.20605251550170225} {:x 6.22136290441852, :y 0.2316252953047228} {:x 6.312135220278314, :y 0.2578101128271451} {:x 6.402907536138109, :y 0.2841317783381155} {:x 6.4936798519979035, :y 0.3100598751301435} {:x 6.584452167857698, :y 0.335025006079551} {:x 6.675224483717493, :y 0.3584386041254276} {:x 6.765996799577287, :y 0.3797154154209896} {:x 6.856769115437082, :y 0.3982974974261749} {:x 6.947541431296877, :y 0.41367838028765985} {:x 7.038313747156671, :y 0.425425941522396} {:x 7.129086063016466, :y 0.4332025563005947} {:x 7.2198583788762605, :y 0.436781213351819} {:x 7.310630694736055, :y 0.4360565232760984} {:x 7.40140301059585, :y 0.4310498743696404} {:x 7.492175326455644, :y 0.42190838399479824} {:x 7.582947642315439, :y 0.4088977172361709} {:x 7.673719958175234, :y 0.39238926200697993} {:x 7.764492274035028, :y 0.3728425244919474} {:x 7.855264589894823, :y 0.3507839089654116} {:x 7.946036905754617, :y 0.3267832475780921} {:x 8.036809221614412, :y 0.30142953480461376} {:x 8.127581537474207, :y 0.27530729529242604} {:x 8.218353853334001, :y 0.24897488128791506} {:x 8.309126169193796, :y 0.22294577463329002} {:x 8.39989848505359, :y 0.19767368361941293} {:x 8.490670800913385, :y 0.17354190583813994} {:x 8.58144311677318, :y 0.15085710439490338} {:x 8.672215432632974, :y 0.12984734381219737} {:x 8.762987748492769, :y 0.11066397613513354} {:x 8.853760064352564, :y 0.09338677293120279} {:x 8.944532380212358, :y 0.0780315733732114} {:x 9.035304696072153, :y 0.06455966335420255} {:x 9.126077011931947, :y 0.05288811007714981} {:x 9.216849327791742, :y 0.04290034025410107} {:x 9.307621643651537, :y 0.0344563541877477} {:x 9.398393959511331, :y 0.027402097485108246} {:x 9.489166275371126, :y 0.02157765220406008} {:x 9.57993859123092, :y 0.01682404681166352} {:x 9.670710907090715, :y 0.012988609054187732} {:x 9.76148322295051, :y 0.009928890470090272} {:x 9.852255538810304, :y 0.007515271802987489} {:x 9.943027854670099, :y 0.005632413909206447} {:x 10.033800170529894, :y 0.004179750227267497} {:x 10.124572486389688, :y 0.0030712275542077623} {:x 10.215344802249483, :y 0.0022344958819236578} {:x 10.306117118109277, :y 0.0016097299313363592} {:x 10.396889433969072, :y 0.0011482392227769786} {:x 10.487661749828867, :y 8.109939866667059E-4} {:x 10.578434065688661, :y 5.671641711964913E-4} {:x 10.669206381548456, :y 3.9274063626346226E-4})}], :marks [{:type \"line\", :from {:data \"295c140e-875c-4721-84fd-0f51601e5df4\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#FF29D2\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"295c140e-875c-4721-84fd-0f51601e5df4\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"295c140e-875c-4721-84fd-0f51601e5df4\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}]}}"}
;; <=

;; **
;;; ## Plot KL error as a function of number of samples
;; **

;; @@
(def num-sample-range 
  (mapv (comp int (partial * number-of-samples))
     [1e-3 2e-3 5e-3 1e-2 2e-2 5e-2 1e-1 2e-1 5e-1 1]))
  
(def KL-errors
  (map (fn [n]
         (let [mus (collect-by :result (take n samples))
			   mean (s/empirical-mean mus)
               sd (s/empirical-std mus)]
			(kl-normal 
              mean 
              sd 
              (:mean posterior) 
              (:sd posterior))))
       num-sample-range))
;; @@
;; =>
;;; {"type":"list-like","open":"","close":"","separator":"</pre><pre>","items":[{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/num-sample-range</span>","value":"#'gaussian-aistats/num-sample-range"},{"type":"html","content":"<span class='clj-var'>#&#x27;gaussian-aistats/KL-errors</span>","value":"#'gaussian-aistats/KL-errors"}],"value":"[#'gaussian-aistats/num-sample-range,#'gaussian-aistats/KL-errors]"}
;; <=

;; @@
(plot/list-plot (map vector 
                     (map #(/ (log %) 
                              (log 10)) 
                          num-sample-range)
                     (map #(/ (log %) 
                              (log 10)) 
                          KL-errors))
                :joined true
                :color "#05A"
                :x-title "log number of samples"
                :y-title "log KL divergence")
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"11b4aae3-7d39-447a-b9e0-662f0f9fa50e","values":[{"x":2.0,"y":0.22096931811169238},{"x":2.301029995663981,"y":-0.20915264506312725},{"x":2.6989700043360183,"y":-0.719403796086361},{"x":2.9999999999999996,"y":-1.2078889268558104},{"x":3.301029995663981,"y":-1.5690951388156735},{"x":3.6989700043360187,"y":-2.572517381419018},{"x":4.0,"y":-4.785534307861646},{"x":4.30102999566398,"y":-3.559901932321342},{"x":4.698970004336019,"y":-3.5059392860692187},{"x":5.0,"y":-3.5712310010618435}]}],"marks":[{"type":"line","from":{"data":"11b4aae3-7d39-447a-b9e0-662f0f9fa50e"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"#05A"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"11b4aae3-7d39-447a-b9e0-662f0f9fa50e","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"11b4aae3-7d39-447a-b9e0-662f0f9fa50e","field":"data.y"}}],"axes":[{"type":"x","scale":"x","title":"log number of samples","titleOffset":30},{"type":"y","scale":"y","title":"log KL divergence","titleOffset":45}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"11b4aae3-7d39-447a-b9e0-662f0f9fa50e\", :values ({:x 2.0, :y 0.22096931811169238} {:x 2.301029995663981, :y -0.20915264506312725} {:x 2.6989700043360183, :y -0.719403796086361} {:x 2.9999999999999996, :y -1.2078889268558104} {:x 3.301029995663981, :y -1.5690951388156735} {:x 3.6989700043360187, :y -2.572517381419018} {:x 4.0, :y -4.785534307861646} {:x 4.30102999566398, :y -3.559901932321342} {:x 4.698970004336019, :y -3.5059392860692187} {:x 5.0, :y -3.5712310010618435})}], :marks [{:type \"line\", :from {:data \"11b4aae3-7d39-447a-b9e0-662f0f9fa50e\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"#05A\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"11b4aae3-7d39-447a-b9e0-662f0f9fa50e\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"11b4aae3-7d39-447a-b9e0-662f0f9fa50e\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\", :title \"log number of samples\", :titleOffset 30} {:type \"y\", :scale \"y\", :title \"log KL divergence\", :titleOffset 45}]}}"}
;; <=

;; @@

;; @@
